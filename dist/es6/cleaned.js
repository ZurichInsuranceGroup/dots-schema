import assign from 'lodash.assign';
import partialRight from 'lodash.partialright';
import { RootValidator } from './validators/root-validator';
export function cleaned(validator, key, definition, options, defaultObject, custom, rule) {
    var defaultOptions = options;
    return function (value, object, options) {
        options = assign({}, defaultOptions, options);
        object = typeof object !== 'undefined' ? object : defaultObject;
        if (options && options.autoClean) {
            value = RootValidator.clean(definition, value, options, object);
        }
        return validator(value, key, definition, object, options, custom, rule);
    };
}
var connectSchema = function (schema, object, context) {
    var validators = schema.getValidators();
    var connected = {};
    for (var field in validators) {
        if (validators.hasOwnProperty(field)) {
            var fieldValidators = validators[field];
            var fieldConnected = {};
            for (var rule in fieldValidators) {
                if (fieldValidators.hasOwnProperty(rule)) {
                    fieldConnected[rule] = partialRight(fieldValidators[rule], object, {
                        context: context,
                        clean: true
                    });
                }
            }
            connected[field] = fieldConnected;
        }
    }
    return connected;
};

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9kb3RzLXNjaGVtYS9jbGVhbmVkLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sTUFBTSxNQUFNLGVBQWUsQ0FBQTtBQUNsQyxPQUFPLFlBQVksTUFBTSxxQkFBcUIsQ0FBQTtBQVU5QyxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sNkJBQTZCLENBQUE7QUFHM0QsTUFBTSxrQkFBa0IsU0FBYyxFQUFFLEdBQVcsRUFBRSxVQUFnQyxFQUFFLE9BQTBCLEVBQUUsYUFBbUIsRUFBRSxNQUFpQixFQUFFLElBQWE7SUFDcEssSUFBTSxjQUFjLEdBQUcsT0FBTyxDQUFBO0lBRTlCLE1BQU0sQ0FBQyxVQUFDLEtBQVUsRUFBRSxNQUFZLEVBQUUsT0FBMkI7UUFDekQsT0FBTyxHQUFHLE1BQU0sQ0FBQyxFQUFFLEVBQUUsY0FBYyxFQUFFLE9BQU8sQ0FBQyxDQUFBO1FBRTdDLE1BQU0sR0FBRyxPQUFPLE1BQU0sS0FBSyxXQUFXLEdBQUcsTUFBTSxHQUFHLGFBQWEsQ0FBQTtRQUUvRCxFQUFFLENBQUMsQ0FBQyxPQUFPLElBQUksT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUM7WUFDL0IsS0FBSyxHQUFHLGFBQWEsQ0FBQyxLQUFLLENBQUMsVUFBVSxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsTUFBTSxDQUFDLENBQUE7UUFDbkUsQ0FBQztRQUVELE1BQU0sQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLEdBQUcsRUFBRSxVQUFVLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsSUFBSSxDQUFDLENBQUE7SUFDM0UsQ0FBQyxDQUFBO0FBQ0wsQ0FBQztBQUVELElBQU0sYUFBYSxHQUFHLFVBQUMsTUFBYyxFQUFFLE1BQVcsRUFBRSxPQUFZO0lBQzVELElBQU0sVUFBVSxHQUFHLE1BQU0sQ0FBQyxhQUFhLEVBQUUsQ0FBQTtJQUN6QyxJQUFNLFNBQVMsR0FBUSxFQUFFLENBQUE7SUFFekIsR0FBRyxDQUFDLENBQUMsSUFBSSxLQUFLLElBQUksVUFBVSxDQUFDLENBQUMsQ0FBQztRQUMzQixFQUFFLENBQUMsQ0FBQyxVQUFVLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNuQyxJQUFNLGVBQWUsR0FBRyxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUE7WUFDekMsSUFBTSxjQUFjLEdBQVEsRUFBRSxDQUFBO1lBQzlCLEdBQUcsQ0FBQyxDQUFDLElBQUksSUFBSSxJQUFJLGVBQWUsQ0FBQyxDQUFDLENBQUM7Z0JBQy9CLEVBQUUsQ0FBQyxDQUFDLGVBQWUsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUN2QyxjQUFjLENBQUMsSUFBSSxDQUFDLEdBQUcsWUFBWSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsRUFBRSxNQUFNLEVBQUU7d0JBQy9ELE9BQU8sRUFBRSxPQUFPO3dCQUNoQixLQUFLLEVBQUUsSUFBSTtxQkFDZCxDQUFDLENBQUE7Z0JBQ04sQ0FBQztZQUNMLENBQUM7WUFDRCxTQUFTLENBQUMsS0FBSyxDQUFDLEdBQUcsY0FBYyxDQUFBO1FBQ3JDLENBQUM7SUFDTCxDQUFDO0lBQ0QsTUFBTSxDQUFDLFNBQVMsQ0FBQTtBQUNwQixDQUFDLENBQUEiLCJmaWxlIjoiY2xlYW5lZC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBhc3NpZ24gZnJvbSAnbG9kYXNoLmFzc2lnbidcbmltcG9ydCBwYXJ0aWFsUmlnaHQgZnJvbSAnbG9kYXNoLnBhcnRpYWxyaWdodCdcbmltcG9ydCBkZWZhdWx0cyBmcm9tICdsb2Rhc2guZGVmYXVsdHMnXG5cbmltcG9ydCB7XG4gICAgVmFsaWRhdGlvbkRlZmluaXRpb24sXG4gICAgRGVmaW5pdGlvblR5cGUsXG4gICAgVmFsaWRhdGlvblJlc3VsdCxcbiAgICBWYWxpZGF0aW9uT3B0aW9ucyxcbiAgICBWYWxpZGF0aW9uRXJyb3Jcbn0gZnJvbSAnLi9pbnRlcmZhY2VzJ1xuaW1wb3J0IHsgUm9vdFZhbGlkYXRvciB9IGZyb20gJy4vdmFsaWRhdG9ycy9yb290LXZhbGlkYXRvcidcbmltcG9ydCB7IFNjaGVtYSB9IGZyb20gJy4vc2NoZW1hJ1xuXG5leHBvcnQgZnVuY3Rpb24gY2xlYW5lZCh2YWxpZGF0b3I6IGFueSwga2V5OiBzdHJpbmcsIGRlZmluaXRpb246IFZhbGlkYXRpb25EZWZpbml0aW9uLCBvcHRpb25zOiBWYWxpZGF0aW9uT3B0aW9ucywgZGVmYXVsdE9iamVjdD86IGFueSwgY3VzdG9tPzogRnVuY3Rpb24sIHJ1bGU/OiBzdHJpbmcpOiBGdW5jdGlvbiB7XG4gICAgY29uc3QgZGVmYXVsdE9wdGlvbnMgPSBvcHRpb25zXG5cbiAgICByZXR1cm4gKHZhbHVlOiBhbnksIG9iamVjdD86IGFueSwgb3B0aW9ucz86IFZhbGlkYXRpb25PcHRpb25zKSA9PiB7XG4gICAgICAgIG9wdGlvbnMgPSBhc3NpZ24oe30sIGRlZmF1bHRPcHRpb25zLCBvcHRpb25zKVxuXG4gICAgICAgIG9iamVjdCA9IHR5cGVvZiBvYmplY3QgIT09ICd1bmRlZmluZWQnID8gb2JqZWN0IDogZGVmYXVsdE9iamVjdFxuXG4gICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuYXV0b0NsZWFuKSB7XG4gICAgICAgICAgICB2YWx1ZSA9IFJvb3RWYWxpZGF0b3IuY2xlYW4oZGVmaW5pdGlvbiwgdmFsdWUsIG9wdGlvbnMsIG9iamVjdClcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB2YWxpZGF0b3IodmFsdWUsIGtleSwgZGVmaW5pdGlvbiwgb2JqZWN0LCBvcHRpb25zLCBjdXN0b20sIHJ1bGUpXG4gICAgfVxufVxuXG5jb25zdCBjb25uZWN0U2NoZW1hID0gKHNjaGVtYTogU2NoZW1hLCBvYmplY3Q6IGFueSwgY29udGV4dDogYW55KTogYW55ID0+IHtcbiAgICBjb25zdCB2YWxpZGF0b3JzID0gc2NoZW1hLmdldFZhbGlkYXRvcnMoKVxuICAgIGNvbnN0IGNvbm5lY3RlZDogYW55ID0ge31cblxuICAgIGZvciAobGV0IGZpZWxkIGluIHZhbGlkYXRvcnMpIHtcbiAgICAgICAgaWYgKHZhbGlkYXRvcnMuaGFzT3duUHJvcGVydHkoZmllbGQpKSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZFZhbGlkYXRvcnMgPSB2YWxpZGF0b3JzW2ZpZWxkXVxuICAgICAgICAgICAgY29uc3QgZmllbGRDb25uZWN0ZWQ6IGFueSA9IHt9XG4gICAgICAgICAgICBmb3IgKGxldCBydWxlIGluIGZpZWxkVmFsaWRhdG9ycykge1xuICAgICAgICAgICAgICAgIGlmIChmaWVsZFZhbGlkYXRvcnMuaGFzT3duUHJvcGVydHkocnVsZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRDb25uZWN0ZWRbcnVsZV0gPSBwYXJ0aWFsUmlnaHQoZmllbGRWYWxpZGF0b3JzW3J1bGVdLCBvYmplY3QsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQ6IGNvbnRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGVhbjogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbm5lY3RlZFtmaWVsZF0gPSBmaWVsZENvbm5lY3RlZFxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjb25uZWN0ZWRcbn1cbiJdfQ==
